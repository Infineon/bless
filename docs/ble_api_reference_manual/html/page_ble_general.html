<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cypress PSoC 6 Bluetooth Low Energy Middleware Library 3.60: General Description</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen_style.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://www.cypress.com/"><img alt="Logo" src="IFXCYP_one-line.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Cypress PSoC 6 Bluetooth Low Energy Middleware Library 3.60</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('page_ble_general.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">General Description </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Bluetooth Low Energy (BLE) middleware contains a comprehensive API to configure the BLE Stack and the underlying chip hardware.</p>
<p>The standalone BT Configurator is shipped in ModusToolbox to make it easy to configure PSoC 6 BLE Middleware.</p>
<p>Include cy_ble_common.h and cy_ble_event_handler.h to get access to all functions and other declarations in this library. If you are using the ModusToolbox BT Configurator, you can include cycfg_ble.h only.</p>
<p>The PSoC 6 BLE Middleware incorporates a Bluetooth Core Specification v5.0 compliant protocol stack. You may access the GAP, GATT and L2CAP layers of the stack using the API.</p>
<p>The API are broadly categorized as follows:</p><ul>
<li><a class="el" href="group__group__ble__common__api.html">BLE Common API</a></li>
<li><a class="el" href="group__group__ble__service__api.html">BLE Service-Specific API</a></li>
</ul>
<p><b>Features:</b></p><ul>
<li>Multi-link supports for up to four simultaneous connections in any combination of roles</li>
<li>Bluetooth v5.0 compliant protocol stack<ul>
<li>LE 2 Mbps</li>
</ul>
</li>
<li>Generic Access Profile (GAP) features<ul>
<li>Broadcaster, Observer, Peripheral and Central roles</li>
<li>User-defined advertising data</li>
<li>Bonding support for up to 128 devices</li>
<li>Security modes 1 and 2</li>
</ul>
</li>
<li>Generic Attribute Profile (GATT) features<ul>
<li>GATT Client and Server</li>
<li>16-, 32-, and 128-bit UUIDs</li>
</ul>
</li>
<li>Special Interest Group (SIG) adopted GATT-based Profiles and Services, and quick prototype of new profile design through intuitive BT Configurator Custom Profile development;</li>
<li>Security Manager features<ul>
<li>Pairing methods: Just works, Passkey Entry, Out of Band, Numeric Comparison (LE Secure connections)</li>
<li>Authenticated man-in-the-middle (MITM) protection and data signing</li>
</ul>
</li>
<li>Logical Link Control and Adaption Protocol (L2CAP) connection-oriented channel</li>
<li>Link Layer (LL) features<ul>
<li>Master and Slave roles</li>
<li>128-bit AES encryption</li>
<li>Low Duty Cycle Advertising</li>
<li>LE Ping</li>
<li>Privacy 1.2</li>
<li>Data length extension (DLE)</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="group_ble_when_use"></a>
When to use the BLE</h1>
<p>BLE is used in very low-power network and Internet of Things (IoT) solutions using low-cost battery operated devices that can quickly connect and form simple wireless links. Target applications include HID, remote controls, sports and fitness monitors, portable medical devices and smart phone accessories, among many others.</p>
<h1><a class="anchor" id="group_ble_sig_adopted"></a>
SIG adopted Profiles and Services</h1>
<p>The BLE resource supports numerous SIG-adopted GATT-based Profiles and Services. Each of these can be configured for either a GATT Client or GATT Server. It generates all the necessary code for a particular Profile/Service operation, as configured in the BLE Configurator.</p>
<h1><a class="anchor" id="group_ble_custom_profile"></a>
Custom Profiles</h1>
<p>You can create custom Profiles that use existing Services, and you can create custom Services with custom Characteristics and Descriptors.</p>
<h1><a class="anchor" id="group_ble_debug_support"></a>
Debug Support</h1>
<p>For testing and debugging, the PSoC 6 BLE Middleware can be configured to use Host Controller Interface (HCI) mode through a UART. Refer to Initialize and Enable PSoC 6 BLE Middleware in Controller-only Mode (HCI over Software API).</p>
<p>For over-the-air verification, the Cypress CySmart Central Emulation Tool can be used for generic Bluetooth host stack emulation.</p>
<h1><a class="anchor" id="group_ble_architecture"></a>
PSoC 6 BLE Middleware Architecture</h1>
<p> <style>div.image img[src="ble_architecture_single_cpu_mode.png"]{width:650px;}</style>   <style>div.image img[src="ble_architecture_hci_mode.png"]{width:650px;}</style> </p>
<p>PSoC 6 BLE Middleware consists of the BLE Stack, BLE Profile, Hardware Abstraction Layer (HAL), and the Link Layer. The following figure shows the high-level architecture of the PSoC 6 BLE Middleware, illustrating the relationship between each of the layers and how the application interacts with the PSoC 6 BLE Middleware. Note that the application uses callback functions to handle BLE events, which you can use to build your state machine.</p>
<p>The following block diagram shows the architecture of PSoC 6 BLE Middleware under Complete BLE Protocol mode. </p><div class="image">
<img src="ble_architecture_single_cpu_mode.png" alt="ble_architecture_single_cpu_mode.png"/>
</div>
<p>The following block diagram shows the architecture of PSoC 6 BLE Middleware under Controller Only mode (HCI over Software API). </p><div class="image">
<img src="ble_architecture_hci_mode.png" alt="ble_architecture_hci_mode.png"/>
</div>
<p>The following sub-sections give an overview of each of these layers.</p>
<h2><a class="anchor" id="group_ble_stack"></a>
BLE Stack</h2>
<p> <style>div.image img[src="ble_stack.png"]{width:550pxpx;}</style> </p>
<p>The BLE stack implements the core BLE functionality as defined in Bluetooth Core Specification 5.0. The stack is included as a pre-compiled library in the PSoC 6 BLE Middleware library. The BLE Stack implements the layered architecture of the BLE protocol stack as shown in the following figure.</p>
<div class="image">
<img src="ble_stack.png" alt="ble_stack.png"/>
</div>
<h3><a class="anchor" id="subsubsection_ble_stack_1"></a>
Generic Access Profile (GAP)</h3>
<p>The Generic Access Profile defines the procedures related to discovery of Bluetooth devices and the link- management aspects of connecting to Bluetooth devices. In addition, this profile includes common format requirements for parameters accessible on the user interface level.</p>
<p>The Generic Access Profile defines the following roles when operating over the LE physical channel:</p><ul>
<li><b>Broadcaster role</b>: A device operating in the Broadcaster role can send advertising events. It is referred to as a Broadcaster. It has a transmitter and may have a receiver.</li>
<li><b>Observer role</b>: A device operating in the Observer role is a device that receives advertising events. It is referred to as an Observer. It has a receiver and may have a transmitter.</li>
<li><b>Peripheral role</b>: A device that accepts an LE physical link using any of the connection establishment procedures is said to have a Peripheral role. A device operating in the Peripheral role will be in the "Slave role" in the Link Layer Connection State. A device operating in the Peripheral role is referred to as a Peripheral. A Peripheral has both a transmitter and a receiver.</li>
<li><b>Central role</b>: A device that supports the Central role initiates the establishment of a physical connection. A device operating in the "Central role" will be in the "Master role" in the Link Layer Connection. A device operating in the Central role is referred to as a Central. A Central has a transmitter and a receiver.</li>
</ul>
<h3><a class="anchor" id="subsubsection_ble_stack_2"></a>
Generic Attribute Profile (GATT)</h3>
<p>The Generic Attribute Profile defines a generic service framework using the ATT protocol layer. This framework defines the procedures and formats of services and their characteristics. It defines the procedures for Service, Characteristic, and Descriptor discovery, reading, writing, notifying, and indicating Characteristics, as well as configuring the broadcast of Characteristics. GATT roles are:</p>
<ul>
<li><b>GATT Client</b>: This is the device that wants data. It initiates commands and requests to the GATT Server. It can receive responses, indications, and notifications data sent by the GATT Server.</li>
<li><b>GATT Server</b>: This is the device that has the data and accepts incoming commands and requests from the GATT Client. It sends responses, indications, and notifications to a GATT Client. The BLE Stack can support both roles simultaneously.</li>
</ul>
<h3><a class="anchor" id="subsubsection_ble_stack_3"></a>
Attribute Protocol (ATT)</h3>
<p>The Attribute Protocol layer defines a Client/Server architecture above the BLE logical transport channel. The attribute protocol allows a device referred to as the GATT Server to expose a set of attributes and their associated values to a peer device referred to as the GATT Client. Attributes exposed by the GATT Server can be discovered, read, and written by a GATT Client, and can be indicated and notified by the GATT Server. All the transactions on attributes are atomic.</p>
<h3><a class="anchor" id="subsubsection_ble_stack_4"></a>
Security Manager Protocol (SMP)</h3>
<p>The Security Manager Protocol defines the procedures and behavior to manage pairing, authentication, and encryption between the devices. These include:</p><ul>
<li>Encryption and Authentication</li>
<li>Pairing and Bonding<ul>
<li>Pass Key and Out of Band bonding</li>
</ul>
</li>
<li>Key Generation for a device identity resolution, data signing, and encryption</li>
<li>Pairing method selection based on the IO capability of the GAP central and GAP peripheral device.</li>
</ul>
<h3><a class="anchor" id="subsubsection_ble_stack_5"></a>
Logical Link Control Adaptation Protocol (L2CAP)</h3>
<p>L2CAP provides a connectionless data channel. LE L2CAP provides the following features:</p><ul>
<li>Channel multiplexing, which manages three fixed channels. Two channels are dedicated for higher protocol layers like ATT, SMP. One channel is used by the LE-L2CAP protocol signalling channel for its own use.</li>
<li>Segmentation and reassembly of packets whose size is up to the BLE Controller managed maximum packet size.</li>
<li>Connection-oriented channel over a specific application registered using the PSM (protocol service multiplexer) channel. It implements credit-based flow control between two LE L2CAP entities. This feature can be used for BLE applications that require transferring large chunks of data.</li>
</ul>
<h3><a class="anchor" id="subsubsection_ble_stack_6"></a>
Host Controller Interface (HCI)</h3>
<p>The HCI layer implements a command, event, and data interface to allow link layer access from upper layers such as GAP, L2CAP, and SMP.</p>
<h3><a class="anchor" id="subsubsection_ble_stack_7"></a>
Link Layer (LL)</h3>
<p>The Link Layer implements a command, event, and data interface to allow link layer access from upper layers such as GAP, L2CAP, and SMP. The LL protocol manages the physical BLE connections between devices. It supports all LL states such as Advertising, Scanning, Initiating, and Connecting (Master and Slave). It implements all the key link control procedures such as LE Encryption, LE Connection Update, LE Channel Update, and LE Ping.</p>
<p>The Link Layer is a hardware-firmware co-implementation, where the key time critical LL functions are implemented in the LL hardware. The LL firmware maintains and controls the key LL procedure state machines. It supports all the BLE chip-specific low-power modes. The BLE Stack is a pre-compiled library. The appropriate configuration of the BLE Stack library is linked during a build process based on the application. The BLE Stack libraries are Arm Embedded Application Binary Interface (EABI) compliant and are compiled using Arm compiler version 5.03.</p>
<h2><a class="anchor" id="group_ble_profile_layer"></a>
Profile Layer</h2>
<p> <style>div.image img[src="ble_profiles.png"]{width:1000px;}</style> </p>
<p>In BLE, data is organized into concepts called Profiles, Services, and Characteristics.</p>
<ul>
<li>A <b>Profile</b> describes how devices connect to each other to find and use Services. The Profile describes the type of application and the general expected behavior of that device. See the <b>Parameter Configuration</b> section of ModusToolbox Bluetooth Configurator Guide for configuring the PSoC 6 BLE Middleware.</li>
<li>A <b>Service</b> is a collection of data entities called Characteristics. A Service is used to define a certain function in a Profile. A Service may also define its relationship to other Services. A Service is assigned a Universally Unique Identifier (UUID). This is 16 bits for SIG adopted Services and 128 bits for custom Services. See the <b>GATT Settings Tab</b> section of ModusToolbox Bluetooth Configurator Guide for information about adding Services to a Profile.</li>
<li>A <b>Characteristic</b> contains a Value and the Descriptor that describes a Characteristic Value. It is an attribute type for a specific piece of information within a Service. Like a Service, each Characteristic is designated with a UUID; 16 bits for SIG adopted Characteristics and 128 bits for custom Characteristics. See the <b>GATT Settings Tab</b> section of ModusToolbox Bluetooth Configurator Guide for information about adding Characteristics and Descriptors. The following diagram shows the relationship between Profiles, Services, and Characteristics in a sample BLE heart rate monitor application using a Heart Rate Profile.</li>
</ul>
<div class="image">
<img src="ble_profiles.png" alt="ble_profiles.png"/>
</div>
<p>The Heart Rate Profile contains a Heart Rate Service and a Device Information Service. Within the Heart Rate Service, there are three Characteristics, each containing different information. The device in the diagram is configured in the Sensor role, meaning that in the context of the Heart Rate Profile, the device is a GAP Peripheral and a GATT Server. These concepts are explained in the <a class="el" href="page_ble_general.html#group_ble_stack">BLE Stack</a> description.</p>
<p>The Profile layer is provided by PSoC 6 BLE Middleware using the parameter configurations specified in the Bluetooth Configurator. The Profile implements the Profile-specific attribute database and functions required for the application. You can choose to configure the standard SIG adopted Profile and generate a design, or define a Custom Profile required by an application.</p>
<h2><a class="anchor" id="group_ble_hal"></a>
Hardware Abstraction Layer (HAL)</h2>
<p>The HAL implements the interface between the BLE stack and the underlying hardware. This layer is meant for the stack only and it is not advisable to modify it. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part
<div id="nav-path" class="navpath">
    <ul>
        <li class="footer">
            Generated for <b>Cypress PSoC 6 Bluetooth Low Energy Middleware Library 3.60</b> by <b>Cypress Semiconductor Corporation</b>.
            All rights reserved.
        </li>
    </ul>
</div>
-->
</body>
</html>
